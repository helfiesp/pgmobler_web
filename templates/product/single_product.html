{% load static %}
{% load form_tags %}
<link rel="stylesheet" href="{% static 'css/products.css' %}">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">




{% if not query %}
    {% for product in products %}
        {% if product.enabled %}

        {% if per_page == 1 %}
            <div class="product-card" style="width:90%">
        {% elif per_page == 2 %}
            <div class="product-card" style="width:46%">
        {% elif per_page == 3 %}
            <div class="product-card" style="width:29%">
        {% else %}
            <div class="product-card" style="width:20%">
        {% endif %}

            <a href="{% url 'product_page' product.id %}" class="product-link">
            <div class="product-image-container">
                <img src="{{ product.images.all.0.image.url }}" alt="{{ product.title }}" class="product-image">
                <img src="{{ product.images.all.1.image.url }}" class="product-image second-image"> <!-- This is the second image -->
                {% if product.sale_price %}
                    {% with difference=product.price|floatformat:"-2"|subtract:product.sale_price|floatformat:"-2" %}
                     <div class="price-overlay">Spar {{ difference }}kr</div>
                     {% endwith %}
                {% endif %}
            </div>

                <div class="product-details">
                    <h2 class="product-name">{{ product.title }}</h2>
                    {% if product.sale_price %}
                        <p class="product-price">{{ product.sale_price }} kr</p>
                    {% else %}
                        <p class="product-price">{{ product.price }} kr</p>
                    {% endif %}
                </div>
            </a>
                {% if product.sale_price %}

                    <div style="margin-top:-8px" class="product-details">
                        <a style="text-decoration: none;" href="{% url 'category_search' product.category %}">
                            <p class="product-category">{{ product.category|upper }}</p>
                        </a>
                            <p class="product-price-dashed">{{ product.price }} kr</p>
                    </div>
                {% else %}
                    <a style="text-decoration: none;" href="{% url 'category_search' product.category %}">
                        <p class="product-category">{{ product.category|upper }}</p>
                    </a>
                {% endif %}
            </a>
        </div>
        {% endif %}
    {% endfor %}
{% else %}
    <!-- For when there is a search going on -->
    {% for product in products %}
        {% if product.enabled %}
            <div class="product-card">
                <a href="{% url 'product_page' product.id %}" class="product-link">
                <div class="product-image-container">
                    <img src="{{ product.images.all.0.image.url }}" alt="{{ product.title }}" class="product-image">
                    <img src="{{ product.images.all.1.image.url }}" class="product-image second-image"> <!-- This is the second image -->
                </div>
                    <div class="product-details">
                        <h2 class="product-name">{{ product.title }}</h2>
                        <p class="product-price">{{ product.price }} kr</p>
                    </div>
                </a>

                <a style="text-decoration: none;" href="{% url 'category_search' product.category %}">
                    <p class="product-category">{{ product.category|upper }}</p>
                </a>
            </div>
            {% endif %}
        }
    {% endfor %}
{% endif %}

